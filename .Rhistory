mutate(
geo = gsub("Germany \\(until 1990 former territory of the FRG\\)","Germany", geo),
plot_date = lubridate::ymd(paste0("2021-",format(time, "%m-%d"))),
year = lubridate::year(time)
) %>%
filter(nrg_bal == "Inland consumption - observed") %>%
filter(unit == "Terajoule (gross calorific value - GCV)") %>%
rename(values, nm = "values_jt")
# df_eurostat_toc
df_monthly_consumption <- get_eurostat("nrg_cb_gasm", type = "label") %>%
mutate(
geo = gsub("Germany \\(until 1990 former territory of the FRG\\)","Germany", geo),
plot_date = lubridate::ymd(paste0("2021-",format(time, "%m-%d"))),
year = lubridate::year(time)
) %>%
filter(nrg_bal == "Inland consumption - observed") %>%
filter(unit == "Terajoule (gross calorific value - GCV)") %>%
rename(values, "values_jt")
# df_eurostat_toc
df_monthly_consumption <- get_eurostat("nrg_cb_gasm", type = "label") %>%
mutate(
geo = gsub("Germany \\(until 1990 former territory of the FRG\\)","Germany", geo),
plot_date = lubridate::ymd(paste0("2021-",format(time, "%m-%d"))),
year = lubridate::year(time)
) %>%
filter(nrg_bal == "Inland consumption - observed") %>%
filter(unit == "Terajoule (gross calorific value - GCV)") %>%
rename(values = "values_jt")
# df_eurostat_toc
df_monthly_consumption <- get_eurostat("nrg_cb_gasm", type = "label") %>%
mutate(
geo = gsub("Germany \\(until 1990 former territory of the FRG\\)","Germany", geo),
plot_date = lubridate::ymd(paste0("2021-",format(time, "%m-%d"))),
year = lubridate::year(time)
) %>%
filter(nrg_bal == "Inland consumption - observed") %>%
filter(unit == "Terajoule (gross calorific value - GCV)") %>%
rename(values_tj = values)
glimpse(df_monthly_consumption)
# df_eurostat_toc
df_monthly_consumption <- get_eurostat("nrg_cb_gasm", type = "label") %>%
mutate(
geo = gsub("Germany \\(until 1990 former territory of the FRG\\)","Germany", geo),
plot_date = lubridate::ymd(paste0("2021-",format(time, "%m-%d"))),
year = lubridate::year(time)
) %>%
filter(nrg_bal == "Inland consumption - observed") %>%
filter(unit == "Terajoule (gross calorific value - GCV)") %>%
rename(values_tj = values) %>%
select(-unit)
glimpse(df_monthly_consumption)
# df_eurostat_toc
df_monthly_consumption <- get_eurostat("nrg_cb_gasm", type = "label") %>%
mutate(
geo = gsub("Germany \\(until 1990 former territory of the FRG\\)","Germany", geo),
plot_date = lubridate::ymd(paste0("2021-",format(time, "%m-%d"))),
year = lubridate::year(time)
) %>%
filter(nrg_bal == "Inland consumption - observed") %>%
filter(unit == "Terajoule (gross calorific value - GCV)") %>%
rename(values_tj = values) %>%
select(-unit) %>%
mutate(values_gwh = values_tj / 36)
glimpse(df_monthly_consumption)
# df_eurostat_toc
df_monthly_consumption <- get_eurostat("nrg_cb_gasm", type = "label") %>%
mutate(
geo = gsub("Germany \\(until 1990 former territory of the FRG\\)","Germany", geo),
plot_date = lubridate::ymd(paste0("2021-",format(time, "%m-%d"))),
year = lubridate::year(time)
) %>%
filter(nrg_bal == "Inland consumption - observed") %>%
filter(unit == "Terajoule (gross calorific value - GCV)") %>%
rename(values_tj = values) %>%
select(-unit) %>%
mutate(values_gwh = values_tj / 3.6)
glimpse(df_monthly_consumption)
# df_eurostat_toc
df_monthly_consumption <- get_eurostat("nrg_cb_gasm", type = "label") %>%
mutate(
geo = gsub("Germany \\(until 1990 former territory of the FRG\\)","Germany", geo),
plot_date = lubridate::ymd(paste0("2021-",format(time, "%m-%d"))),
year = lubridate::year(time)
) %>%
filter(nrg_bal == "Inland consumption - observed") %>%
filter(unit == "Terajoule (gross calorific value - GCV)") %>%
rename(values_tj = values) %>%
select(-unit) %>%
mutate(values_gwh = values_tj / 3.6)
glimpse(df_monthly_consumption)
df_monthly_consumption %>%
group_by(geo, year) %>%
filter(geo == "Belgium") %>%
summarise(totalConsumption = sum(values_gwh))
df_avg_consumption <- df_monthly_consumption %>%
group_by(geo, plot_date) %>%
summarise(avg_values = mean(values_gwh, na.rm = TRUE)) %>%
ungroup()
df_avg_consumption %>%
filter(geo %in% c("Belgium","France","Netherlands","Germany","European Union - 27 countries (from 2020)")) %>%
ggplot(aes(x = plot_date, y = avg_values)) +
geom_area(alpha = 0.2) +
geom_line() +
facet_wrap(~geo, scales = "free_y") +
theme_minimal() +
theme(legend.position = "top")
df_monthly_consumption %>%
group_by(geo, year) %>%
filter(geo == "Belgium") %>%
summarise(totalConsumptionGWh = sum(values_gwh))
df_avg_consumption <- df_monthly_consumption %>%
group_by(geo, plot_date) %>%
summarise(avg_values = mean(values_gwh, na.rm = TRUE)) %>%
ungroup()
df_avg_consumption %>%
filter(geo %in% c("Belgium","France","Netherlands","Germany","European Union - 27 countries (from 2020)")) %>%
ggplot(aes(x = plot_date, y = avg_values)) +
geom_area(alpha = 0.2) +
geom_line() +
facet_wrap(~geo, scales = "free_y") +
theme_minimal() +
theme(legend.position = "top")
df_avg_consumption <- df_monthly_consumption %>%
group_by(geo, plot_date) %>%
summarise(avg_values = mean(values_gwh, na.rm = TRUE)) %>%
ungroup()
df_avg_consumption %>%
filter(geo %in% c("Belgium","France","Netherlands","Germany","European Union - 27 countries (from 2020)")) %>%
ggplot(aes(x = plot_date, y = avg_values)) +
geom_area(alpha = 0.2) +
geom_line() +
facet_wrap(~geo, scales = "free_y") +
labs(
subtitle = "monthly consumption natural gas, in GWh"
)
theme_minimal() +
theme(legend.position = "top")
df_avg_consumption <- df_monthly_consumption %>%
group_by(geo, plot_date) %>%
summarise(avg_values = mean(values_gwh, na.rm = TRUE)) %>%
ungroup()
df_avg_consumption %>%
filter(geo %in% c("Belgium","France","Netherlands","Germany","European Union - 27 countries (from 2020)")) %>%
ggplot(aes(x = plot_date, y = avg_values)) +
geom_area(alpha = 0.2) +
geom_line() +
facet_wrap(~geo, scales = "free_y") +
labs(
subtitle = "monthly consumption natural gas, in GWh"
) +
theme_minimal() +
theme(legend.position = "top")
df_avg_consumption <- df_monthly_consumption %>%
group_by(geo, plot_date) %>%
summarise(avg_values = mean(values_gwh, na.rm = TRUE)) %>%
ungroup()
df_avg_consumption %>%
filter(geo %in% c("Belgium","France","Netherlands","Germany","European Union - 27 countries (from 2020)")) %>%
ggplot(aes(x = plot_date, y = avg_values)) +
geom_area(alpha = 0.2) +
geom_line() +
facet_wrap(~geo, scales = "free_y") +
labs(
subtitle = "Monthly consumption natural gas, in GWh"
) +
theme_minimal() +
theme(legend.position = "top")
df_avg_consumption <- df_monthly_consumption %>%
group_by(geo, plot_date) %>%
summarise(avg_values = mean(values_gwh, na.rm = TRUE)) %>%
ungroup()
df_avg_consumption %>%
filter(geo %in% c("Belgium","France","Netherlands","Germany","European Union - 27 countries (from 2020)")) %>%
ggplot(aes(x = plot_date, y = avg_values)) +
geom_area(alpha = 0.2) +
geom_line() +
facet_wrap(~geo, scales = "free_y") +
labs(
subtitle = "Monthly consumption natural gas, in GWh",
caption = "Source: Eurostat"
) +
theme_minimal() +
theme(legend.position = "top")
df_avg_consumption <- df_monthly_consumption %>%
group_by(geo, plot_date) %>%
summarise(avg_values = mean(values_gwh, na.rm = TRUE)) %>%
ungroup()
df_avg_consumption %>%
filter(geo %in% c("Belgium","France","Netherlands","Germany","European Union - 27 countries (from 2020)")) %>%
ggplot(aes(x = plot_date, y = avg_values)) +
geom_area(alpha = 0.2) +
geom_line() +
scale_x_date() +
facet_wrap(~geo, scales = "free_y") +
labs(
subtitle = "Monthly consumption natural gas, in GWh",
caption = "Source: Eurostat"
) +
theme_minimal() +
theme(legend.position = "top")
df_avg_consumption <- df_monthly_consumption %>%
group_by(geo, plot_date) %>%
summarise(avg_values = mean(values_gwh, na.rm = TRUE)) %>%
ungroup()
df_avg_consumption %>%
filter(geo %in% c("Belgium","France","Netherlands","Germany","European Union - 27 countries (from 2020)")) %>%
ggplot(aes(x = plot_date, y = avg_values)) +
geom_area(alpha = 0.2) +
geom_line() +
scale_x_date(labels = format("%B")) +
facet_wrap(~geo, scales = "free_y") +
labs(
subtitle = "Monthly consumption natural gas, in GWh",
caption = "Source: Eurostat"
) +
theme_minimal() +
theme(legend.position = "top")
df_avg_consumption <- df_monthly_consumption %>%
group_by(geo, plot_date) %>%
summarise(avg_values = mean(values_gwh, na.rm = TRUE)) %>%
ungroup()
df_avg_consumption %>%
filter(geo %in% c("Belgium","France","Netherlands","Germany","European Union - 27 countries (from 2020)")) %>%
ggplot(aes(x = plot_date, y = avg_values)) +
geom_area(alpha = 0.2) +
geom_line() +
scale_x_date(date_labels = "%B") +
facet_wrap(~geo, scales = "free_y") +
labs(
subtitle = "Monthly consumption natural gas, in GWh",
caption = "Source: Eurostat"
) +
theme_minimal() +
theme(legend.position = "top")
df_avg_consumption <- df_monthly_consumption %>%
group_by(geo, plot_date) %>%
summarise(avg_values = mean(values_gwh, na.rm = TRUE)) %>%
ungroup()
df_avg_consumption %>%
filter(geo %in% c("Belgium","France","Netherlands","Germany","European Union - 27 countries (from 2020)")) %>%
ggplot(aes(x = plot_date, y = avg_values)) +
geom_area(alpha = 0.2) +
geom_line() +
scale_x_date(date_labels = "%b") +
facet_wrap(~geo, scales = "free_y") +
labs(
subtitle = "Monthly consumption natural gas, in GWh",
caption = "Source: Eurostat"
) +
theme_minimal() +
theme(legend.position = "top")
df_avg_consumption <- df_monthly_consumption %>%
group_by(geo, plot_date) %>%
summarise(avg_values = mean(values_gwh, na.rm = TRUE)) %>%
ungroup()
df_avg_consumption %>%
filter(geo %in% c("Belgium","France","Netherlands","Germany","European Union - 27 countries (from 2020)")) %>%
ggplot(aes(x = plot_date, y = avg_values)) +
geom_area(alpha = 0.2) +
geom_line() +
scale_x_date(date_labels = "%b") +
facet_wrap(~geo, scales = "free") +
labs(
subtitle = "Monthly consumption natural gas, in GWh",
caption = "Source: Eurostat"
) +
theme_minimal() +
theme(legend.position = "top")
df_avg_consumption <- df_monthly_consumption %>%
group_by(geo, plot_date) %>%
summarise(avg_values = mean(values_gwh, na.rm = TRUE)) %>%
ungroup()
df_avg_consumption %>%
filter(geo %in% c("Belgium","France","Netherlands","Germany","European Union - 27 countries (from 2020)")) %>%
ggplot(aes(x = plot_date, y = avg_values)) +
geom_area(alpha = 0.2) +
geom_line(linetype = "11") +
scale_x_date(date_labels = "%b") +
facet_wrap(~geo, scales = "free") +
labs(
subtitle = "Monthly consumption natural gas, in GWh",
caption = "Source: Eurostat"
) +
theme_minimal() +
theme(legend.position = "top")
filter_countries <- c("European Union - 27 countries (from 2020)")
df_monthly_consumption %>%
filter(geo %in% filter_countries) %>%
ggplot(aes(x = plot_date, y = values, col = as.factor(year))) +
geom_area(data = subset(df_avg_consumption, geo %in% filter_countries),
aes(x = plot_date, y = avg_values), col = "black", linetype = "11", alpha = 0.1) +
geom_line(alpha = 0.6) +
gghighlight::gghighlight(year >= 2020, calculate_per_facet = T, use_direct_label = F) +
scale_x_date(date_labels = "%b") +
facet_wrap(~geo, scales = "free") +
labs(
subtitle = "Monthly consumption natural gas, in GWh",
caption = "Source: Eurostat"
) +
scale_color_manual(values = c("orange","blue")) +
theme_minimal() +
theme(legend.position = "top")
filter_countries <- c("European Union - 27 countries (from 2020)")
df_monthly_consumption %>%
filter(geo %in% filter_countries) %>%
ggplot(aes(x = plot_date, y = values_gwh, col = as.factor(year))) +
geom_area(data = subset(df_avg_consumption, geo %in% filter_countries),
aes(x = plot_date, y = avg_values), col = "black", linetype = "11", alpha = 0.1) +
geom_line(alpha = 0.6) +
gghighlight::gghighlight(year >= 2020, calculate_per_facet = T, use_direct_label = F) +
scale_x_date(date_labels = "%b") +
facet_wrap(~geo, scales = "free") +
labs(
subtitle = "Monthly consumption natural gas, in GWh",
caption = "Source: Eurostat"
) +
scale_color_manual(values = c("orange","blue")) +
theme_minimal() +
theme(legend.position = "top")
df_avg_consumption <- df_monthly_consumption %>%
group_by(geo, plot_date) %>%
summarise(avg_values = mean(values_gwh, na.rm = TRUE)) %>%
ungroup()
df_avg_consumption %>%
filter(geo %in% c("Belgium","France","Netherlands","Germany","European Union - 27 countries (from 2020)")) %>%
ggplot(aes(x = plot_date, y = avg_values)) +
geom_area(alpha = 0.2) +
geom_line(linetype = "11") +
scale_x_date(date_labels = "%b") +
facet_wrap(~geo, scales = "free") +
labs(
x = "", y = "",
subtitle = "Monthly consumption natural gas, in GWh",
caption = "Source: Eurostat"
) +
theme_minimal() +
theme(legend.position = "top")
filter_countries <- c("European Union - 27 countries (from 2020)")
df_monthly_consumption %>%
filter(geo %in% filter_countries) %>%
ggplot(aes(x = plot_date, y = values_gwh, col = as.factor(year))) +
geom_area(data = subset(df_avg_consumption, geo %in% filter_countries),
aes(x = plot_date, y = avg_values), col = "black", linetype = "11", alpha = 0.1) +
geom_line(alpha = 0.6) +
gghighlight::gghighlight(year >= 2020, calculate_per_facet = T, use_direct_label = F) +
scale_x_date(date_labels = "%b") +
facet_wrap(~geo, scales = "free") +
labs(
x = "", y = "",
subtitle = "Monthly consumption natural gas, in GWh",
caption = "Source: Eurostat"
) +
scale_color_manual(values = c("orange","blue")) +
theme_minimal() +
theme(legend.position = "top")
filter_countries <- c("Belgium","France","Netherlands","Germany")
df_monthly_consumption %>%
filter(geo %in% filter_countries) %>%
ggplot(aes(x = plot_date, y = values, col = as.factor(year))) +
geom_area(data = subset(df_avg_consumption, geo %in% filter_countries),
aes(x = plot_date, y = avg_values), col = "black", linetype = "11", alpha = 0.1) +
geom_line(alpha = 0.6) +
gghighlight::gghighlight(year >= 2020, calculate_per_facet = T, use_direct_label = F) +
scale_x_date(date_labels = "%b") +
facet_wrap(~geo, scales = "free") +
labs(
x = "", y = "",
subtitle = "Monthly consumption natural gas, in GWh",
caption = "Source: Eurostat"
) +
scale_color_manual(values = c("orange","blue")) +
theme_minimal() +
theme(legend.position = "top")
filter_countries <- c("Belgium","France","Netherlands","Germany")
df_monthly_consumption %>%
filter(geo %in% filter_countries) %>%
ggplot(aes(x = plot_date, y = values_gwh, col = as.factor(year))) +
geom_area(data = subset(df_avg_consumption, geo %in% filter_countries),
aes(x = plot_date, y = avg_values), col = "black", linetype = "11", alpha = 0.1) +
geom_line(alpha = 0.6) +
gghighlight::gghighlight(year >= 2020, calculate_per_facet = T, use_direct_label = F) +
scale_x_date(date_labels = "%b") +
facet_wrap(~geo, scales = "free") +
labs(
x = "", y = "",
subtitle = "Monthly consumption natural gas, in GWh",
caption = "Source: Eurostat"
) +
scale_color_manual(values = c("orange","blue")) +
theme_minimal() +
theme(legend.position = "top")
df_gas_storage %>%
filter(country_name %in% c("Belgium")) %>%
select(country_name, gasDayStartedOn, gasInStorage, full) %>%
mutate(
gasInStorage_Terajoule = gasInStorage,
time = lubridate::floor_date(gasDayStartedOn, "1 month")
) %>%
group_by(country_name, time) %>%
summarise(avgGasInStorage = mean(gasInStorage, na.rm = TRUE)) %>%
ggplot(aes(x = time, y = avgGasInStorage)) +
geom_line()
get_eurostat("nrg_cb_gasm", type = "label") %>%
mutate(
geo = gsub("Germany \\(until 1990 former territory of the FRG\\)","Germany", geo),
plot_date = lubridate::ymd(paste0("2021-",format(time, "%m-%d"))),
year = lubridate::year(time)
) %>%
filter(nrg_bal == "Inland consumption - observed") %>%
filter(unit == "Terajoule (gross calorific value - GCV)") %>%
rename(values_tj = values) %>%
select(-unit) %>%
mutate(values_gwh = values_tj / 3.6)
get_eurostat("nrg_cb_gasm", type = "label")
get_eurostat("nrg_cb_gasm", type = "label") %>%
mutate(
geo = gsub("Germany \\(until 1990 former territory of the FRG\\)","Germany", geo),
plot_date = lubridate::ymd(paste0("2021-",format(time, "%m-%d"))),
year = lubridate::year(time)
) %>%
filter(nrg_bal %in% c("Inland consumption - observed","Imports")) %>%
filter(unit == "Terajoule (gross calorific value - GCV)") %>%
rename(values_tj = values) %>%
select(-unit) %>%
mutate(values_gwh = values_tj / 3.6) %>%
filter(geo == "Belgium")
get_eurostat("nrg_cb_gasm", type = "label") %>%
mutate(
geo = gsub("Germany \\(until 1990 former territory of the FRG\\)","Germany", geo),
plot_date = lubridate::ymd(paste0("2021-",format(time, "%m-%d"))),
year = lubridate::year(time)
) %>%
filter(nrg_bal %in% c("Inland consumption - observed","Imports")) %>%
filter(unit == "Terajoule (gross calorific value - GCV)") %>%
rename(values_tj = values) %>%
select(-unit) %>%
mutate(values_gwh = values_tj / 3.6) %>%
filter(geo == "Belgium") %>%
ggplot(aes(x = time, y = values_gwh, fill = nrg_bal)) +
geom_col()
get_eurostat("nrg_cb_gasm", type = "label") %>%
mutate(
geo = gsub("Germany \\(until 1990 former territory of the FRG\\)","Germany", geo),
plot_date = lubridate::ymd(paste0("2021-",format(time, "%m-%d"))),
year = lubridate::year(time)
) %>%
filter(nrg_bal %in% c("Inland consumption - observed","Imports")) %>%
filter(unit == "Terajoule (gross calorific value - GCV)") %>%
rename(values_tj = values) %>%
select(-unit) %>%
mutate(values_gwh = values_tj / 3.6) %>%
filter(geo == "Belgium") %>%
ggplot(aes(x = time, y = values_gwh, fill = nrg_bal)) +
geom_col(width = 1)
get_eurostat("nrg_cb_gasm", type = "label") %>%
mutate(
geo = gsub("Germany \\(until 1990 former territory of the FRG\\)","Germany", geo),
plot_date = lubridate::ymd(paste0("2021-",format(time, "%m-%d"))),
year = lubridate::year(time)
) %>%
filter(nrg_bal %in% c("Inland consumption - observed","Imports")) %>%
filter(unit == "Terajoule (gross calorific value - GCV)") %>%
rename(values_tj = values) %>%
select(-unit) %>%
mutate(values_gwh = values_tj / 3.6) %>%
filter(geo == "Belgium") %>%
ggplot(aes(x = time, y = values_gwh, fill = nrg_bal)) +
geom_area()
get_eurostat("nrg_cb_gasm", type = "label") %>%
mutate(
geo = gsub("Germany \\(until 1990 former territory of the FRG\\)","Germany", geo),
plot_date = lubridate::ymd(paste0("2021-",format(time, "%m-%d"))),
year = lubridate::year(time)
) %>%
filter(nrg_bal %in% c("Inland consumption - observed","Imports")) %>%
filter(unit == "Terajoule (gross calorific value - GCV)") %>%
rename(values_tj = values) %>%
select(-unit) %>%
mutate(values_gwh = values_tj / 3.6) %>%
filter(geo == "Belgium") %>%
ggplot(aes(x = time, y = values_gwh, fill = nrg_bal)) +
geom_area(position = "fill")
library(dplyr)
library(jsonlite)
library(httr)
library(osmdata)
big_streets <- getbb("Asheville United States")%>%
opq()%>%
add_osm_feature(key = "highway",
value = c("motorway", "primary", "motorway_link", "primary_link")) %>%
osmdata_sf()
bbox_flanders <- c(2.5416,50.6874,5.9112,51.5051)
q <- bbox_flanders %>%
opq (timeout = 25*100) %>%
add_osm_feature("shop") %>%
osmdata_sf()
library(dplyr)
library(osmdata)
bbox_flanders <- c(2.5416,50.6874,5.9112,51.5051)
q <- bbox_flanders %>%
opq (timeout = 25*100) %>%
add_osm_feature("shop") %>%
osmdata_sf()
dat <- opq ("deutschland") %>%
add_osm_feature (key = "de:regionalschluessel", value = "^07", value_exact = FALSE) %>%
osmdata_sf ()
dat <- opq ("deutschland") %>%
add_osm_feature (key = "de:regionalschluessel", value = "^07", value_exact = FALSE) %>%
osmdata_sf ()
dat <- opq ("deutschland") %>%
add_osm_feature (key = "de:regionalschluessel", value = "^07", value_exact = FALSE) %>%
osmdata_sf ()
